---
platform: linux
image_resource:
  type: docker-image
  source:
    repository: tkaburagi/vault-role-id
    tag: latest
inputs:
  - name: repo
  - name: out
run:
  path: sh
  args:
    - -c
    - |
      # ‼️Put Secrets to Vault KV‼️

      # ‼️Login to Vault by AppRole‼️
      vault write auth/approle/login role_id=$(cat /role-id) secret_id=$(cat out/secretid)

      # ‼️Generate AWS Secrets‼️